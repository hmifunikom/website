(function(a){if(typeof define!=="undefined"&&define.amd){define(["jquery"],a)}else{if(typeof module!=="undefined"&&module.exports){var b=require("jquery");module.exports=a(b)}else{window.scrollMonitor=a(jQuery)}}})(function(h){var H={};var w=h(window);var F=h(document);var g=[];var E="visibilityChange";var B="enterViewport";var z="fullyEnterViewport";var n="exitViewport";var k="partiallyExitViewport";var x="locationChange";var m="stateChange";var o=[E,B,z,n,k,x,m];var G={top:0,bottom:0};H.viewportTop;H.viewportBottom;H.documentHeight;H.viewportHeight=q();var v;var s;function q(){return window.innerHeight||document.documentElement.clientHeight}var a;function t(){H.viewportTop=w.scrollTop();H.viewportBottom=H.viewportTop+H.viewportHeight;H.documentHeight=F.height();if(H.documentHeight!==v){a=g.length;while(a--){g[a].recalculateLocation()}v=H.documentHeight}}function r(){H.viewportHeight=q();t();p()}var b;function u(){clearTimeout(b);b=setTimeout(r,100)}var f;function p(){f=g.length;while(f--){g[f].update()}f=g.length;while(f--){g[f].triggerCallbacks()}}function l(Q,J){var T=this;this.watchItem=Q;if(!J){this.offsets=G}else{if(J===+J){this.offsets={top:J,bottom:J}}else{this.offsets=h.extend({},G,J)}}this.callbacks={};for(var O=0,N=o.length;O<N;O++){T.callbacks[o[O]]=[]}this.locked=false;var M;var R;var S;var P;var I;var e;function L(i){if(i.length===0){return}I=i.length;while(I--){e=i[I];e.callback.call(T,s);if(e.isOne){i.splice(I,1)}}}this.triggerCallbacks=function K(){if(this.isInViewport&&!M){L(this.callbacks[B])}if(this.isFullyInViewport&&!R){L(this.callbacks[z])}if(this.isAboveViewport!==S&&this.isBelowViewport!==P){L(this.callbacks[E]);if(!R&&!this.isFullyInViewport){L(this.callbacks[z]);L(this.callbacks[k])}if(!M&&!this.isInViewport){L(this.callbacks[B]);L(this.callbacks[n])}}if(!this.isFullyInViewport&&R){L(this.callbacks[k])}if(!this.isInViewport&&M){L(this.callbacks[n])}if(this.isInViewport!==M){L(this.callbacks[E])}switch(true){case M!==this.isInViewport:case R!==this.isFullyInViewport:case S!==this.isAboveViewport:case P!==this.isBelowViewport:L(this.callbacks[m])}M=this.isInViewport;R=this.isFullyInViewport;S=this.isAboveViewport;P=this.isBelowViewport};this.recalculateLocation=function(){if(this.locked){return}var V=this.top;var U=this.bottom;if(this.watchItem.nodeName){var i=this.watchItem.style.display;if(i==="none"){this.watchItem.style.display=""}var j=h(this.watchItem).offset();this.top=j.top;this.bottom=j.top+this.watchItem.offsetHeight;if(i==="none"){this.watchItem.style.display=i}}else{if(this.watchItem===+this.watchItem){if(this.watchItem>0){this.top=this.bottom=this.watchItem}else{this.top=this.bottom=H.documentHeight-this.watchItem}}else{this.top=this.watchItem.top;this.bottom=this.watchItem.bottom}}this.top-=this.offsets.top;this.bottom+=this.offsets.bottom;this.height=this.bottom-this.top;if((V!==undefined||U!==undefined)&&(this.top!==V||this.bottom!==U)){L(this.callbacks[x])}};this.recalculateLocation();this.update();M=this.isInViewport;R=this.isFullyInViewport;S=this.isAboveViewport;P=this.isBelowViewport}l.prototype={on:function(e,j,i){switch(true){case e===E&&!this.isInViewport&&this.isAboveViewport:case e===B&&this.isInViewport:case e===z&&this.isFullyInViewport:case e===n&&this.isAboveViewport&&!this.isInViewport:case e===k&&this.isAboveViewport:j();if(i){return}}if(this.callbacks[e]){this.callbacks[e].push({callback:j,isOne:i})}else{throw new Error("Tried to add a scroll monitor listener of type "+e+". Your options are: "+o.join(", "))}},off:function(I,J){if(this.callbacks[I]){for(var e=0,j;j=this.callbacks[I][e];e++){if(j.callback===J){this.callbacks[I].splice(e,1);break}}}else{throw new Error("Tried to remove a scroll monitor listener of type "+I+". Your options are: "+o.join(", "))}},one:function(e,i){this.on(e,i,true)},recalculateSize:function(){this.height=this.watchItem.offsetHeight+this.offsets.top+this.offsets.bottom;this.bottom=this.top+this.height},update:function(){this.isAboveViewport=this.top<H.viewportTop;this.isBelowViewport=this.bottom>H.viewportBottom;this.isInViewport=(this.top<=H.viewportBottom&&this.bottom>=H.viewportTop);this.isFullyInViewport=(this.top>=H.viewportTop&&this.bottom<=H.viewportBottom)||(this.isAboveViewport&&this.isBelowViewport)},destroy:function(){var J=g.indexOf(this),e=this;g.splice(J,1);for(var K=0,I=o.length;K<I;K++){e.callbacks[o[K]].length=0}},lock:function(){this.locked=true},unlock:function(){this.locked=false}};var d=function(e){return function(j,i){this.on.call(this,e,j,i)}};for(var C=0,A=o.length;C<A;C++){var c=o[C];l.prototype[c]=d(c)}try{t()}catch(D){h(t)}function y(e){s=e;t();p()}w.on("scroll",y);w.on("resize",u);H.beget=H.create=function(i,j){if(typeof i==="string"){i=h(i)[0]}if(i instanceof h){i=i[0]}var e=new l(i,j);g.push(e);e.update();return e};H.update=function(){s=null;t();p()};H.recalculateLocations=function(){H.documentHeight=0;H.update()};return H});